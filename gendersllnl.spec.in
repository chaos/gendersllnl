Name:    @PROJECT@
Version: @VERSION@
Release: @RELEASE@
Summary: LLNL site specific genders libraries
Group: System Environment/Base
License: GPL
Source: %{name}-%{version}.tar.gz
Requires: genders >= 1.2
BuildRequires: genders >= 1.2
BuildRoot: %{_tmppath}/%{name}-%{version}

%description
Gendersllnl is a set of Lawrence Livermore National Laboratory (LLNL)
site specific genders libraries.  The libraries contain API functions
specifically for LLNL tools.

%package dist
Summary: LLNL file distribution tools
Group: System Environment/Base
Requires: pdsh >= 2.0-0.pre18
%description dist
Sets of file distribution tools used specifically by LLNL.  The tools
will most likely not work by default in a non-LLNL environment.

%{!?_with_perl_extensions: %{!?_without_perl_extensions: %define _with_perl_extensions --with-perl-extensions}}

%prep
%setup  -q -n %{name}-%{version}

%build
%configure --program-prefix=%{?_program_prefix:%{_program_prefix}} \
    --with-perl-destdir="$RPM_BUILD_ROOT" \
    %{?_with_perl_extensions} \
    %{?_without_perl_extensions}
make 

%install
rm -rf $RPM_BUILD_ROOT
DESTDIR="$RPM_BUILD_ROOT" make install 

%files
%defattr(-,root,root)
%doc README ChangeLog COPYING NEWS DISCLAIMER DISCLAIMER.UC
# It doesn't matter if the user chooses a 32bit or 64bit target.  The
# packaging must work off whatever Perl is installed.
%define _perldir %(perl -e 'use Config; $T=$Config{installsitearch}; $T=~/(.*)\\/site_perl.*/; print $1;')
%{_mandir}/man3/*
%{_includedir}/*
%{_libdir}/libgendersllnl.*
%if %{?_with_perl_extensions:1}%{!?_with_perl_extensions:0}
%{_perldir}/*
%endif

%files dist
%defattr(-,root,root)
%doc dist/TUTORIAL dist/Distfile.sample
%{_mandir}/man1/*
%{_bindir}/*
